/**
 * Created by aesop on 2016/2/2.
 */
'use strict';
const should = require('chai').should;
const init = require('../lib/file-list').allFileList,
    config = require('../lib/config'),
    part = require('../lib/os').partedSymbol,
    del = require('../lib/os').delCommad,
    fs = require('fs'),
    exec = require('child_process').execSync;

describe('init module', function () {
    before(function () {
        config.setConfig({
            'rootPath': [process.cwd(), 'test', 'sample'].join(part),
            "ignore": [[], [], [".html$", ".php$"]],
            "dir": ["images", "css", "php"],
             leaveFileLog: false
        });
    });
    after(function () {
        config.setConfig({
            'rootPath': '.',
            leaveFileLog: true
        });
        del.map(x=>exec(x+['test','dist','php'].join(part)));
        fs.rmdirSync('test/dist');
    });
    it('should return right files', function () {
        let result = init().sort();
        result.should.deep.equal(['css' + part + 'style.css',
            'images' + part + 'a.jpg',
            'images' + part + 'b.png'].sort())
    })
})